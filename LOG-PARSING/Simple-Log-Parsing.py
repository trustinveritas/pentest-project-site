"""
Author      : AnyGuy
Date        : 2023-05-26

Title       : Simple-Log-Parsing.py

Description : Here comes text
    
SAMPLE DATA :
200 OK           12.55.22.88 jr22          2019-03-18T09:21:17 /login
200 OK           14.56.23.11 rand99        2019-03-18T10:19:22 /login
200 OK           17.33.10.38 afer11        2019-03-18T11:11:44 /login
200 OK           99.12.44.20 rad4          2019-03-18T11:55:51 /login
200 OK           67.34.22.10 bff1          2019-03-18T13:08:59 /login
200 OK           34.55.11.14 hax0r         2019-03-21T16:08:15 /login
401 Unauthorised 49.99.13.16 admin         2019-03-21T21:08:15 /login
401 Unauthorised 49.99.13.16 administrator 2019-03-21T21:08:20 /login
401 Unauthorised 49.99.13.16 anonymous     2019-03-21T21:08:25 /login
401 Unauthorised 49.99.13.16 root          2019-03-21T21:08:30 /login 

"""

# Import Libraries
import csv

# Pfad zur Logdatei
log_file_path = "/path/to/login-logs.txt"

# Pfad zur CSV-Ausgabedatei
output_file_path = "/output/path/to/login-logs.csv"

# Header für die CSV-Datei
header = ["HTTP-STATUS", "IP", "USERNAME", "DATE-TIME", "PATH"]

# Eröffnung der Ausgabedatei und Schreiben des Headers
with open(output_file_path, 'w', newline='') as csvfile:
    writer = csv.writer(csvfile)
    writer.writerow(header)

    # Öffnen der Logdatei und Parsen jeder Zeile
    with open(log_file_path, 'r') as logfile:
        for line in logfile:
            # Aufteilung der Zeile in ihre Komponenten
            components = line.split()

            # Überprüfung, ob die Zeile die richtige Anzahl von Komponenten hat
            if len(components) == 6:
                http_status = components[0] + " " + components[1]
                ip = components[2]
                username = components[3]
                date_time = components[4]
                path = components[5]

                # Schreiben der Komponenten in die CSV-Datei
                writer.writerow([http_status, ip, username, date_time, path])
