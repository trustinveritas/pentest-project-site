"""
Author      : AnyGuy
Date        : 2023-07-05

Title       : GETwinARTEFACTS.ps1

Description : Gathering evidence of activities performed on computers.
    
    - Windows Registry Forensics
    - System Information and System Accounts
    - Evidence of Execution
    - External Devices / USB Device Forensics

"""

# Main Function
function MainMenu {
    param(
        [string]$OutputPath = "C:\Output"
    )

    Clear-Host
    Write-Host @"

888       888 d8b               888                                  
888   o   888 Y8P               888                                  
888  d8b  888                   888                                  
888 d888b 888 888 88888b.   .d88888  .d88b.  888  888  888 .d8888b   
888d88888b888 888 888 "88b d88" 888 d88""88b 888  888  888 88K       
88888P Y88888 888 888  888 888  888 888  888 888  888  888 "Y8888b.  
8888P   Y8888 888 888  888 Y88b 888 Y88..88P Y88b 888 d88P      X88  
888P     Y888 888 888  888  "Y88888  "Y88P"   "Y8888888P"   88888P'  
                                                                     
                                                                     
                                                                     
       d8888         888             .d888                  888      
      d88888         888            d88P"                   888      
     d88P888         888            888                     888      
    d88P 888 888d888 888888 .d88b.  888888 8888b.   .d8888b 888888   
   d88P  888 888P"   888   d8P  Y8b 888       "88b d88P"    888      
  d88P   888 888     888   88888888 888   .d888888 888      888      
 d8888888888 888     Y88b. Y8b.     888   888  888 Y88b.    Y88b.    
d88P     888 888      "Y888 "Y8888  888   "Y888888  "Y8888P  "Y888   
                                                                     
                                                                     
                                                                     
 .d8888b.           888 888                   888                    
d88P  Y88b          888 888                   888                    
888    888          888 888                   888                    
888         .d88b.  888 888  .d88b.   .d8888b 888888 .d88b.  888d888 
888        d88""88b 888 888 d8P  Y8b d88P"    888   d88""88b 888P"   
888    888 888  888 888 888 88888888 888      888   888  888 888     
Y88b  d88P Y88..88P 888 888 Y8b.     Y88b.    Y88b. Y88..88P 888     
 "Y8888P"   "Y88P"  888 888  "Y8888   "Y8888P  "Y888 "Y88P"  888     

by trustinveritas
Source: https://github.com/trustinveritas
                                                                     
"@ -ForegroundColor Yellow

    Write-Host @"
             _.-;;-._
      '-..-'|   ||   |
      '-..-'|_.-;;-._|
      '-..-'|   ||   |
      '-..-'|_.-''-._|
      
"@ -ForegroundColor Red


# START - Functions for Windows Forensic

# Function - Collect Registry Artifacts
function CollectRegistryArtifacts {
    param(
        [string]$OutputPath
    )

    # Collect registry artifacts here.
    # This is an example. You'll need to implement the other options.
    Write-Host ""
    Write-Host "Collecting Registry Artifacts..."
    copy-item -path "HKLM:\SAM" -Destination "$OutputPath\SAM.bak" -recurse
    # ... and so on for the other registry artifacts
}

# Function - Collect Windows Event Logs
function CollectEventLogs {
    param(
        [string]$OutputPath
    )

    # Collect windows event logs here
}

# Function - Collect System Information
    function CollectSystemInfo {
        param(
            [string]$OutputPath
        )
    }

# END - Functions for Windows Forensic

# Function for the Main Menu
function MainMenu {

    Write-Host ""
    Write-Host "| ------------------------------------ |"
    Write-Host "| Windows Forensic Artifact Collector: |"
    Write-Host "| ------------------------------------ |"
    Write-Host ""
    Write-Host "`nPlease choose from the following options (Numbers):"
    Write-Host "-----------------------------------------------------"
    Write-Host ""
    Write-Host "[ 1] Collect All Artifacts"
    Write-Host "[ 2] Collect Registry Artifacts"
    Write-Host "[ 3] Collect Windows Event Logs"
    Write-Host "[ 4] Collect System Information"
    Write-Host "[ 5] Collect All WiFi Data"
    Write-Host "[ 6] Collect All User Profiles and Their Settings"
    Write-Host "[ 7] Collect Windows 10 Timeline"
    Write-Host "[ 8] Collect BAM/DAM"
    Write-Host "[ 9] Collect System Resource Usage Monitor"
    Write-Host "[10] Collect Recycle Bin"
    Write-Host "[11] Exit"
    Write-Host ""
    Write-Host ""
    $UserInput = Read-Host "Choose an option: "

    # User Selection
    Switch ($UserInput) {
        1..10 {
            $OutputPath = Read-Host "Please enter the output path: "
            Switch ($UserInput) {
                1 { CollectAllArtifacts $OutputPath }
                2 { CollectRegistryArtifacts $OutputPath }
                3 { CollectEventLogs $OutputPath }
                4 { CollectSystemInfo $OutputPath }
                5 { CollectWifiData $OutputPath }
                6 { CollectUserProfiles $OutputPath }
                7 { CollectWin10Timeline $OutputPath }
                8 { CollectBAMandDAM $OutputPath }
                9 { CollectResourceUsageMonitor $OutputPath }
                10 { CollectRecycleBin $OutputPath }
            }
        }
        11 { exit }
        Default { MainMenu }
    }
}


#

# Start the script with the main menu.
MainMenu
